image: maven:3.6.1

pipelines:
  default:
    - step:
        name: maven clean
        caches:
          - maven
        script:
          - mvn clean
    - step:
        name: maven package
        caches:
          - maven
        script:
          - mvn package 
          - ls target/
           
        
    - step: &build-test-sonarcloud
               name: Build, test and analyze on SonarCloud
               caches:
                 - maven
                 - sonar
               script:
                 - mvn -B verify org.sonarsource.scanner.maven:sonar-maven-plugin:sonar
               artifacts:
                 - target/**

      pipelines:                 
            branches:
            dev:
             - step: *build-test-sonarcloud
            pull-requests:
            '**':
             - step: *build-test-sonarcloud
    
    
    
   